/* Copyright (c) 2014 Michael Eisenbraun (http://jquery.michaeleisenbraun.com)
 * Licensed under the MIT License.
 *
 * Version: 1.0.0
 *
 * Requires: jQuery 1.7.2+
 */
if(!window.console)var console={log:function(){}};!function(t){t.fn.guardian=function(e){return this.each(function(){var n=t(this),i=n.data("guardian");return i||n.data("guardian",i=new a(this,e)),i}).data("guardian")};var a=function(a,e){return this.$el=t(a),e&&t.extend(this,e),this.init()};a.prototype={$patterns:{alpha:/^[a-z_'&]+$/i,alnum:/^[\w'&]+$/,number:/^(-?)((\d+)|(\d+).(\d*))$/,currency:/^(-)?(\$)?(\d+)+(,?\d{3})*(\.\d{2})?$/,zip:/(^\d{5,9}$)|(^\d{5}-\d{4}$)/,year:/(^(19|20)\d{2})$/,phone:/^\(?(\d{3})\)?[-. ]?(\d{3})[-. ]?(\d{4})$/,email:/^[\w&]([\w\-\.'&]*)@([\w\-\.]*)(\.[a-z]{2,6}(\.[a-z]{2}){0,2})$/i,url:/^(([http|https]+):)(\/{2})([0-9.\-A-Za-z]+)\.([0-9.\-A-Za-z]+)\.([0-9.\-A-Za-z]+)(?::(\d+))?(?:\/([^?#]*))?(?:\?([^#]*))?(?:#(.*))?$/,date:/^(Jan|January|Feb|February|Mar|March|Apr|April|May|Jun|June|Jul|July|Aug|August|Sep|September|Oct|October|Nov|November|Dec|December|(0?\d{1})|(10|11|12))(-|\s|\/|\.)(0?[1-9]|(1|2)[0-9]|3(0|1))(-|\s|\/|\.|,\s)(19|20)?\d\d$/i},$status:{changed:!1,submitted:!1},$inputs:null,$groups:null,$textInputs:["text","password","currency"],$matchInputs:["match"],$hiddenInputs:["hidden","submit","button"],$phoneInputs:["tel","phone"],$numberInputs:["number","num"],$emailInputs:["email"],$fileInputs:["file"],$radioInputs:["radio"],$checkboxInputs:["checkbox"],$customInputs:null,init:function(){var a=this,e=this.$el;a.$inputs={},a.$groups={},a.customInputs=[];for(var n=t("*[data-group-name]",e),i=n.length,r=0;i>r;r++)this.addGroup(n.eq(r));e.attr("novalidate","novalidate"),e.on("blur",":input",this,a.onBlur);var s=t("[data-counter]",e);return s.each(function(){var a=t(this),n=a.attr("name"),i=e.attr("id");if(a.attr("maxlength")){var r=a.val(),s=parseInt(a.attr("maxlength"),10),u=s-r.length,h=a.width();a.addClass("ui-counter"),a.after('<div class="ui-counters" style="width:'+h+'px"><span id="counter-'+i+"-"+n+'">'+u+"</span> Characters left</div>")}else a.removeAttr("data-counter")}),e.on("keyup",":input[data-counter]",function(){var a=t(this),n=a.val(),i=e.attr("id"),r=a.attr("name"),s=parseInt(a.attr("maxlength"),10),u=s-n.length;t("#counter-"+i+"-"+r).html(u)}),e.on("submit",function(e){var n=t(this),i=n.find(":input");i.length;return a.$event=e,a.$status.submitted=!0,a.before&&a.before(),a.validateAll()?a.success?a.success():!0:(a.$status.submitted=!1,a.failure&&a.failure(),!1)}),a.extend&&a.extend(),a},addGroup:function(a){var e=a.data("group-name");if(a.addClass("group"),this.$groups[e]={min:a.data("group-min")?a.data("group-min"):0,max:a.data("group-max")?a.data("group-max"):1/0,count:0,members:a.data("group-members")?a.data("group-members").split(" "):null},this.$groups[e].members)for(var n=this.$groups[e].members.length,i=0;n>i;i++)t('*[name="'+this.$groups[e].members[i]+'"]').attr("data-group",e)},addInputTypes:function(a){var e=this;t.each(a,function(t,a){switch(t){case"text":e.$textInputs.push(a);break;case"match":e.$matchInputs.push(a);break;case"hidden":e.$hiddenInputs.push(a);break;case"phone":e.$phoneInputs.push(a);break;case"number":e.$numberInputs.push(a);break;case"email":e.$emailInputs.push(a);break;case"radio":e.$radioInputs.push(a);break;case"checkbox":e.$checkboxInputs.push(a);break;case"custom":e.$customInputs.push(a)}})},addPattern:function(a){a&&t.extend(this.$patterns,a)},createErrorMessage:function(a){var e=a.attr("name"),n=a.val(),i=this.$el.attr("id"),r=a.data("error-message"),s=a.data("empty-message");t("#error-message-"+i+"-"+e).length||(r||s)&&a.after('<span class="ui-error-message" id="error-message-'+i+"-"+e+'"></span>'),!n.length&&s?t("#error-message-"+i+"-"+e).html(s):t("#error-message-"+i+"-"+e).html(r)},addCommas:function(t){for(var a=/(\d+)(\d{3})/;a.test(t);)t=t.replace(a,"$1,$2");return t},formatPhone:function(t){return t.replace(this.$patterns.phone,"($1) $2-$3")},formatCurrency:function(t){var a=this;return t.replace(a.$patterns.currency,function(){arguments[3]=arguments[3].length>3?a.addCommas(arguments[3]):arguments[3];var t=arguments[3];return t=arguments[2]?arguments[2]+arguments[3]:"$"+arguments[3],arguments[1]&&(t=arguments[1]+t),arguments[4]&&(t+=arguments[4]),t+=arguments[5]?arguments[5]:".00"})},getInvalid:function(){var t=[];this.$inputs.length;for(el in this.$inputs)this.$inputs[el]||t.push(el);return t},isIE:function(){return/MSIE (\d+\.\d+);/.test(navigator.userAgent)?!0:void 0},isFF3:function(){if(/Firefox[\/\s](\d+\.\d+)/.test(navigator.userAgent)){var t=new Number(RegExp.$1);if(4>=t)return!0}},onBlur:function(a){var e=a.data,n=t(this),i=(n.attr("name"),n.parent());e.$event=a,e.validateElement(n),"change"===a.type&&(e.$status.changed=!0),i.removeClass(e.highlight)},onFocus:function(t){},validationHandler:function(a){var e=(a[0].tagName,a[0].type),n=a.attr("name"),i={parent:a.parent()},r=a.data("group"),s=this.$groups[r],u=this.$el.attr("id");if(i.valid=this.$inputs[n],s){var h=s.members,d=h.length;if(i.parent=t("#"+r),"checkbox"===e)a.is(":checked")?s.count++:"submit"!==this.$event.type&&s.count>0&&s.count--,s.count<s.min||s.count>s.max?(i.valid=!1,this.$inputs[r]=!1):(i.valid=!0,this.$inputs[r]=!0);else for(var l=0;d>l;l++)this.$inputs[h[l]]||(i.valid=!1)}-1===t.inArray(e,this.$hiddenInputs)&&(i.valid?(i.parent.addClass(this.valid).removeClass(this.invalid),t("#error-message-"+u+"-"+n).hide()):(i.parent.addClass(this.invalid).removeClass(this.valid),this.createErrorMessage(a),t("#error-message-"+u+"-"+n).fadeIn()))},validateAll:function(){var a=this,e=a.$el.find(":input");return a.$event={type:null},t.each(a.$groups,function(t,a){a.count=0}),t.each(e,function(){a.validateElement(t(this))}),a.getInvalid().length?!1:!0},validateCustom:function(t){console.log(t)},validateHidden:function(t){var a=t.attr("name");return val=t.val(),this.$inputs[a]=!0,this.$inputs[a]},validatePhone:function(t){var a=t.attr("name"),e=t.val();return this.$inputs[a]=!0,(t.attr("required")||e.length)&&(this.$patterns.phone.test(e)?(this.$inputs[a]=!0,t.val(this.formatPhone(e))):this.$inputs[a]=!1),this.validationHandler(t),this.$inputs[a]},validateNumber:function(t){var a=t.attr("name"),e=parseFloat(t.val()),n=t.attr("min")?Number(t.attr("min")):-(1/0),i=t.attr("max")?Number(t.attr("max")):1/0;return this.$inputs[a]=!0,(t.attr("required")||e.length)&&(isNaN(e)===!0&&(this.$inputs[a]=!1),(n>e||e>i)&&(this.$inputs[a]=!1),"undefined"!=typeof pattern&&(this.$patterns[pattern].test(e)||(this.$inputs[a]=!1))),this.$inputs[a]&&!isNaN(e)&&t.val(e),this.validationHandler(t),this.$inputs[a]},validateEmail:function(t){var a=t.attr("name"),e=t.val();return this.$inputs[a]=!0,(t.attr("required")||e.length)&&(this.$patterns.email.test(e)?this.$inputs[a]=!0:this.$inputs[a]=!1),this.validationHandler(t),this.$inputs[a]},validateText:function(t){var a=t.attr("name"),e=t.val(),n=t.data("pattern");return this.$inputs[a]=!0,(t.attr("required")||e.length)&&("undefined"!=typeof n?this.$patterns[n].test(e)||(this.$inputs[a]=!1):e.trim().length||(this.$inputs[a]=!1)),"currency"==n&&this.$inputs[a]&&t.val(this.formatCurrency(e)),this.validationHandler(t),this.$inputs[a]},validateFile:function(t){var a=t.attr("name"),e=t.val();return this.$inputs[a]=!1,e&&(this.$inputs[a]=!0),this.validationHandler(t),this.$inputs[a]},validateRadio:function(a){var e=a.attr("name");return this.$inputs[e]=!0,a.attr("required")&&(this.$inputs[e]=!1,t('input[name="'+e+'"]').each(function(){t(this).is(":checked")&&(this.$inputs[e]=!0)})),this.validationHandler(a),this.$inputs[e]},validateCheckbox:function(t){var a=t.attr("name");return this.$inputs[a]=!0,t.attr("required")&&!t.is(":checked")&&(this.$inputs[a]=!1),this.validationHandler(t),this.$inputs[a]},validateSelect:function(t){var a=t.attr("name");return val=t.val(),this.$inputs[a]=!0,!t.attr("required")||""!==val&&val||(this.$inputs[a]=!1),this.validationHandler(t),this.$inputs[a]},validateTextarea:function(t){var a=t.attr("name"),e=t.val(),n=t.data("pattern");return this.$inputs[a]=!0,(t.attr("required")||e.length)&&("undefined"!=typeof n?this.$patterns[n].test(e)||(this.$inputs[a]=!1):this.$patterns.alnum.test(e)||(this.$inputs[a]=!1)),this.validationHandler(t),this.$inputs[a]},validateMatch:function(a){var e=a.attr("name"),n=a.val(),i=t("#"+a.data("match-input"));return this.$inputs[e]=!0,(a.attr("required")||n.length)&&(("phone"==i.data("pattern")||"tel"==i.attr("type"))&&a.val(this.formatPhone(n)),n!=i.val()&&(this.$inputs[e]=!1)),this.validationHandler(a),this.$inputs[e]},validateElement:function(a){var e=a[0].tagName,n=a[0].type,i=a.attr("name"),r=a.data("pattern"),s=parseInt(a.attr("minlength")),u=parseInt(a.attr("maxlength")),h=a.val();if(!isNaN(s)&&s>0&&h.length<s)return this.$inputs[i]=!1,this.validationHandler(a),!1;if(!isNaN(u)&&u>0&&h.length>u)return this.$inputs[i]=!1,this.validationHandler(a),!1;switch(e){case"INPUT":if(-1!=t.inArray(n,this.$customInputs)||-1!=t.inArray(r,this.$customInputs))return this.validateCustom(a);if(-1!=t.inArray(n,this.$matchInputs)||-1!=t.inArray(r,this.$matchInputs))return this.validateMatch(a);if(-1!=t.inArray(n,this.$hiddenInputs)||-1!=t.inArray(r,this.$hiddenInputs))return this.validateHidden(a);if(-1!=t.inArray(n,this.$phoneInputs)||-1!=t.inArray(r,this.$phoneInputs))return this.validatePhone(a);if(-1!=t.inArray(n,this.$numberInputs)||-1!=t.inArray(r,this.$numberInputs))return this.validateNumber(a);if(-1!=t.inArray(n,this.$emailInputs)||-1!=t.inArray(r,this.$emailInputs))return this.validateEmail(a);if(-1!=t.inArray(n,this.$textInputs)||-1!=t.inArray(r,this.$textInputs))return this.validateText(a);if(-1!=t.inArray(n,this.$fileInputs)||-1!=t.inArray(r,this.$fileInputs))return this.validateFile(a);if(-1!=t.inArray(n,this.$radioInputs))return this.validateRadio(a);if(-1!=t.inArray(n,this.$checkboxInputs))return this.validateCheckbox(a);break;case"BUTTON":return this.validateHidden(a);case"SELECT":return this.validateSelect(a);case"TEXTAREA":return this.validateTextarea(a);default:return t.error("Element type or data pattern could not be found."),!1}},valid:"ui-state-valid",invalid:"ui-state-invalid",highlight:"ui-state-highlight",before:null,success:null,failure:null,extend:null}}(jQuery);